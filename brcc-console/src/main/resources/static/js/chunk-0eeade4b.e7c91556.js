(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0eeade4b"],{"6d67":function(e,t,a){"use strict";var r=a("5ca1"),n=a("0a49")(1);r(r.P+r.F*!a("2f21")([].map,!0),"Array",{map:function(e){return n(this,e,arguments[1])}})},"75fc":function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var r=a("a745"),n=a.n(r),o=a("db2a");function s(e){if(n()(e))return Object(o["a"])(e)}var i=a("67bb"),l=a.n(i),d=a("5d58"),c=a.n(d),u=a("774e"),m=a.n(u);function p(e){if("undefined"!==typeof l.a&&null!=e[c.a]||null!=e["@@iterator"])return m()(e)}var f=a("e630");function b(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(e){return s(e)||p(e)||Object(f["a"])(e)||b()}},febd:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("section",{staticClass:"add-btn"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("\n            "+e._s(e.$t("permisson.btn.add"))+"\n        ")])],1),a("section",{staticClass:"content"},[a("a-table",{attrs:{columns:e.userColumns,"data-source":e.tabledata,"row-key":function(e){return e.id},pagination:e.pagination,loading:e.loading},scopedSlots:e._u([{key:"operation",fn:function(t,r){return[a("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.handleEdit(r)}}},[e._v(e._s(e.$t("permisson.table.operation.edit")))]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:e.$t("permisson.table.operation.delete.tips")},on:{confirm:function(t){return e.handleDelete(r)}}},[a("a",{attrs:{href:"javascript:;",type:"primary"}},[e._v(e._s(e.$t("permisson.table.operation.delete")))])])]}}])},[e._l(e.userColumns,(function(t,r){return a("template",{slot:t.scopedSlots.title},[a("span",{key:r},[e._v(e._s(e.$t(t.scopedSlots.title)))])])}))],2)],1),a("a-drawer",{attrs:{title:e.formModal.title,visible:e.formModal.show,width:"720","body-style":{paddingBottom:"80px"}},on:{close:e.onClose}},[a("a-form",{attrs:{form:e.form,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"id"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id",{initialValue:e.formData.id}],expression:"['id',{initialValue:formData.id}]"}]})],1),"add"===e.formModal.option?a("a-form-item",{attrs:{label:e.$t("permisson.table.columns.name")}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:e.$t("permisson.table.columns.name.message")}],initialValue:e.formData.name}],expression:"['name',{rules: [{ required: true, message: $t('permisson.table.columns.name.message')}], initialValue: formData.name}]"}],attrs:{placeholder:e.$t("permisson.table.columns.name.placeholder")}})],1):e._e(),a("a-form-item",{attrs:{label:e.$t("permisson.table.columns.role")}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isAdmin",{initialValue:e.formData.isAdmin}],expression:"['isAdmin', {initialValue: formData.isAdmin}]"}]},[a("a-radio",{attrs:{value:1}},[e._v("\n                        "+e._s(e.$t("permisson.table.columns.role.admin"))+"\n                    ")]),a("a-radio",{attrs:{value:0}},[e._v("\n                        "+e._s(e.$t("permisson.table.columns.role.member"))+"\n                    ")])],1)],1),0===e.form.getFieldValue("isAdmin")?a("a-table",{attrs:{columns:e.columns,"row-key":function(e){return e.envId},pagination:!1,"data-source":e.rolesdata},scopedSlots:e._u([{key:"read",fn:function(t,r,n){return[a("a-checkbox",{attrs:{checked:t},on:{change:function(t){return e.onChange(r,n,"read")}}})]}},{key:"write",fn:function(t,r,n){return[a("a-checkbox",{attrs:{checked:t},on:{change:function(t){return e.onChange(r,n,"write")}}})]}}],null,!1,2216865449)},[e._l(e.columns,(function(t,r){return a("template",{slot:t.scopedSlots.title},[a("span",{key:r},[e._v(e._s(e.$t(t.scopedSlots.title)))])])}))],2):e._e()],1),a("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:1}},[a("a-button",{style:{marginRight:"8px"},on:{click:e.onClose}},[e._v("\n                "+e._s(e.$t("permisson.btn.cancel"))+"\n            ")]),a("a-button",{attrs:{type:"primary"},on:{click:e.handleOk}},[e._v("\n                "+e._s(e.$t("permisson.btn.submit"))+"\n            ")])],1)],1)],1)},n=[],o=(a("1c01"),a("58b2"),a("8e6e"),a("f3e2"),a("d25f"),a("ac6a"),a("456d"),a("28a5"),a("75fc")),s=a("bd86");a("7f7f"),a("6d67");function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){Object(s["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d={data:function(){var e=this;return{userColumns:[{dataIndex:"userName",align:"center",scopedSlots:{title:"permisson.table.columns.name"}},{dataIndex:"isAdmin",align:"center",scopedSlots:{title:"permisson.table.columns.role"},customRender:function(t){return t?e.$t("permisson.table.columns.role.admin"):e.$t("permisson.table.columns.role.member")}},{dataIndex:"operation",scopedSlots:{customRender:"operation",title:"permisson.table.columns.operation"},align:"center"}],columns:[{dataIndex:"envName",align:"center",scopedSlots:{title:"permisson.table.columns.envname"}},{dataIndex:"read",align:"center",scopedSlots:{customRender:"read",title:"permisson.table.columns.readable"}},{dataIndex:"write",align:"center",scopedSlots:{customRender:"write",title:"permisson.table.columns.writeable"}}],tabledata:[],rolesdata:[],pagination:{total:0,current:1,pageSize:10,sortBy:"id desc",hideOnSinglePage:!0,showTotal:function(e,t){return"显示 ".concat(t[0]," ~ ").concat(t[1]," 条记录，共 ").concat(e," 条记录")}},loading:!1,formModal:{},formData:{},form:this.$form.createForm(this),labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:17}}}},created:function(){this.getUserlist()},methods:{handleAdd:function(){this.formModal={show:!0,title:this.$t("permisson.btn.add"),option:"add"},this.getRoleList(),this.formData={}},onClose:function(){this.formModal.show=!1},getUserlist:function(){var e=this;this.$api.project.getUserList({projectId:this.$route.query.projectId}).then((function(t){e.tabledata=t.data}))},getRoleList:function(){var e=this;this.$api.env.getEnvList({projectId:this.$route.query.projectId}).then((function(t){e.rolesdata=t.data.dataList.map((function(e){return{envName:e.name,envId:e.id,read:!1,write:!1}}))}))},handleEdit:function(e){var t=this;this.$api.role.getUserRoles(e.productId,e.projectId,e.userId).then((function(e){var a=e.data.itemList.map((function(e){return l(l({},e),{},{read:0!==e.priType,write:2===e.priType})}));t.form.setFieldsValue({isAdmin:e.data.isAdmin}),t.rolesdata=Object(o["a"])(a)})),this.formModal={show:!0,title:this.$t("permisson.btn.edit"),option:"edit",userName:e.userName}},handleDelete:function(e){var t=this,a=[];a.push(e.userId),this.$api.project.deleteProjectMember(e.productId,e.projectId,a).then((function(e){0===e.status&&(t.$message.success("success"),t.getUserlist())}))},handleOk:function(){var e=this;this.form.validateFields((function(t){if(!t){var a=e.rolesdata.map((function(e){return{envId:e.envId,envName:e.envName,priType:e.read+e.write}})),r={};r="add"===e.formModal.option?{isAdmin:e.form.getFieldValue("isAdmin"),memberNameList:e.form.getFieldValue("name").split(","),envPriDtoList:a}:{isAdmin:e.form.getFieldValue("isAdmin"),envPriDtoList:a,memberNameList:[e.formModal.userName]},e.$api.role.addUser(e.$route.query.productId,e.$route.query.projectId,r).then((function(t){0===t.status&&(e.$message.success("success"),e.formModal.show=!1,e.form.resetFields(),e.getUserlist())}))}}))},onChange:function(e,t,a){"write"===a?e.write?this.rolesdata[t].write=!1:(this.rolesdata[t].read=!0,this.rolesdata[t].write=!0):e.read?(this.rolesdata[t].read=!1,this.rolesdata[t].write=!1):this.rolesdata[t].read=!0},routerTo:function(e){this.$router.push(e)}}},c=d,u=a("2877"),m=Object(u["a"])(c,r,n,!1,null,null,null);t["default"]=m.exports}}]);